<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Builder - ToolMatrix.space</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/workflow.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="workflow-page">

<!-- ========== WORKFLOW NAVBAR ========== -->
<nav class="workflow-navbar">
    <div class="nav-container">
        <a href="index.html" class="logo">
            <i class="fas fa-arrow-left"></i>
            <span>Tool<span class="highlight">Matrix</span></span>
        </a>
        <div class="workflow-nav-center">
            <input type="text" id="workflowName" class="workflow-name-input" 
                   placeholder="My Workflow" value="Untitled Workflow">
        </div>
        <div class="workflow-nav-actions">
            <button class="btn-nav-action" id="btnSaveWorkflow" title="Save Workflow">
                <i class="fas fa-save"></i>
                <span>Save</span>
            </button>
            <button class="btn-nav-action" id="btnLoadWorkflow" title="My Workflows">
                <i class="fas fa-folder-open"></i>
                <span>My Workflows</span>
            </button>
            <button class="btn-nav-action btn-run" id="btnRunWorkflow" title="Run Workflow">
                <i class="fas fa-play"></i>
                <span>Run</span>
            </button>
        </div>
    </div>
</nav>

<!-- ========== MAIN WORKFLOW AREA ========== -->
<div class="workflow-container">

    <!-- LEFT SIDEBAR - Tool Palette -->
    <aside class="tool-palette" id="toolPalette">
        <div class="palette-header">
            <h3><i class="fas fa-toolbox"></i> Tools</h3>
            <input type="text" id="toolSearch" placeholder="Search tools..." class="tool-search">
        </div>

        <div class="palette-categories">
            <!-- PDF Tools -->
            <div class="palette-category">
                <div class="category-header" data-toggle="pdf-tools">
                    <i class="fas fa-file-pdf" style="color:#e74c3c"></i>
                    <span>PDF Tools</span>
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
                <div class="category-tools" id="pdf-tools">
                    <div class="palette-tool" draggable="true" data-tool="pdf-compress" data-category="pdf">
                        <i class="fas fa-compress"></i>
                        <span>Compress PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-merge" data-category="pdf">
                        <i class="fas fa-object-group"></i>
                        <span>Merge PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-split" data-category="pdf">
                        <i class="fas fa-cut"></i>
                        <span>Split PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-to-jpg" data-category="pdf">
                        <i class="fas fa-image"></i>
                        <span>PDF to JPG</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="jpg-to-pdf" data-category="pdf">
                        <i class="fas fa-file-pdf"></i>
                        <span>JPG to PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-protect" data-category="pdf">
                        <i class="fas fa-lock"></i>
                        <span>Protect PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-unlock" data-category="pdf">
                        <i class="fas fa-unlock"></i>
                        <span>Unlock PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-rotate" data-category="pdf">
                        <i class="fas fa-sync-alt"></i>
                        <span>Rotate PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-watermark" data-category="pdf">
                        <i class="fas fa-tint"></i>
                        <span>Add Watermark</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-pagenumber" data-category="pdf">
                        <i class="fas fa-sort-numeric-down"></i>
                        <span>Page Numbers</span>
                    </div>
                </div>
            </div>

            <!-- Image Tools -->
            <div class="palette-category">
                <div class="category-header" data-toggle="image-tools">
                    <i class="fas fa-image" style="color:#3498db"></i>
                    <span>Image Tools</span>
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
                <div class="category-tools" id="image-tools">
                    <div class="palette-tool" draggable="true" data-tool="img-compress" data-category="image">
                        <i class="fas fa-compress-arrows-alt"></i>
                        <span>Compress Image</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="img-resize" data-category="image">
                        <i class="fas fa-expand-arrows-alt"></i>
                        <span>Resize Image</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="img-crop" data-category="image">
                        <i class="fas fa-crop-alt"></i>
                        <span>Crop Image</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="img-convert" data-category="image">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Convert Format</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="img-watermark" data-category="image">
                        <i class="fas fa-stamp"></i>
                        <span>Add Watermark</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="img-rotate" data-category="image">
                        <i class="fas fa-redo"></i>
                        <span>Rotate Image</span>
                    </div>
                </div>
            </div>

            <!-- Convert Tools -->
            <div class="palette-category">
                <div class="category-header" data-toggle="convert-tools">
                    <i class="fas fa-exchange-alt" style="color:#2ecc71"></i>
                    <span>Convert</span>
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
                <div class="category-tools" id="convert-tools">
                    <div class="palette-tool" draggable="true" data-tool="word-to-pdf" data-category="convert">
                        <i class="fas fa-file-word"></i>
                        <span>Word to PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="excel-to-pdf" data-category="convert">
                        <i class="fas fa-file-excel"></i>
                        <span>Excel to PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="ppt-to-pdf" data-category="convert">
                        <i class="fas fa-file-powerpoint"></i>
                        <span>PPT to PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="html-to-pdf" data-category="convert">
                        <i class="fas fa-code"></i>
                        <span>HTML to PDF</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="pdf-to-word" data-category="convert">
                        <i class="fas fa-file-alt"></i>
                        <span>PDF to Word</span>
                    </div>
                </div>
            </div>

            <!-- Text Tools -->
            <div class="palette-category">
                <div class="category-header" data-toggle="text-tools">
                    <i class="fas fa-font" style="color:#9b59b6"></i>
                    <span>Text Tools</span>
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
                <div class="category-tools" id="text-tools">
                    <div class="palette-tool" draggable="true" data-tool="text-case" data-category="text">
                        <i class="fas fa-text-height"></i>
                        <span>Change Case</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="text-count" data-category="text">
                        <i class="fas fa-calculator"></i>
                        <span>Word Count</span>
                    </div>
                    <div class="palette-tool" draggable="true" data-tool="text-find-replace" data-category="text">
                        <i class="fas fa-search"></i>
                        <span>Find & Replace</span>
                    </div>
                </div>
            </div>
        </div>
    </aside>

    <!-- CENTER - Workflow Canvas -->
    <main class="workflow-canvas-area">
        <!-- Upload Zone (First step) -->
        <div class="upload-zone" id="uploadZone">
            <div class="upload-content">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Start Your Workflow</h3>
                <p>Drag & drop your files here or click to browse</p>
                <p class="upload-hint">Then drag tools from the left panel to build your pipeline</p>
                <input type="file" id="fileInput" multiple hidden>
                <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-plus"></i> Select Files
                </button>
            </div>
        </div>

        <!-- File Info Bar -->
        <div class="file-info-bar" id="fileInfoBar" style="display:none;">
            <div class="file-chips" id="fileChips"></div>
            <button class="btn-add-more" onclick="document.getElementById('fileInput').click()">
                <i class="fas fa-plus"></i> Add More
            </button>
        </div>

        <!-- Workflow Pipeline -->
        <div class="workflow-pipeline-builder" id="workflowPipeline">
            <div class="pipeline-placeholder" id="pipelinePlaceholder">
                <div class="drop-zone-indicator">
                    <i class="fas fa-plus-circle"></i>
                    <p>Drag tools here to build your workflow</p>
                </div>
            </div>
        </div>

        <!-- Run Button (bottom) -->
        <div class="workflow-run-bar" id="runBar" style="display:none;">
            <button class="btn btn-run-large" id="btnRunLarge">
                <i class="fas fa-play-circle"></i>
                Process Workflow
                <span class="step-count" id="stepCount">0 steps</span>
            </button>
        </div>

        <!-- Progress Overlay -->
        <div class="processing-overlay" id="processingOverlay" style="display:none;">
            <div class="processing-content">
                <div class="processing-spinner"></div>
                <h3>Processing Your Workflow</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">Step 1 of 3: Compressing PDF...</p>
            </div>
        </div>

        <!-- Result Zone -->
        <div class="result-zone" id="resultZone" style="display:none;">
            <div class="result-content">
                <i class="fas fa-check-circle"></i>
                <h3>Workflow Complete!</h3>
                <p class="result-summary" id="resultSummary"></p>
                <div class="result-actions">
                    <button class="btn btn-primary btn-download" id="btnDownload">
                        <i class="fas fa-download"></i> Download Result
                    </button>
                    <button class="btn btn-secondary" id="btnReset">
                        <i class="fas fa-redo"></i> Start Over
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- RIGHT SIDEBAR - Tool Settings -->
    <aside class="tool-settings" id="toolSettings" style="display:none;">
        <div class="settings-header">
            <h3><i class="fas fa-cog"></i> <span id="settingsTitle">Tool Settings</span></h3>
            <button class="btn-close-settings" id="btnCloseSettings">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="settings-body" id="settingsBody">
            <!-- Dynamic settings will be loaded here -->
        </div>
    </aside>
</div>

<!-- ========== LOAD WORKFLOWS MODAL ========== -->
<div class="modal-overlay" id="loadModal" style="display:none;">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-folder-open"></i> My Saved Workflows</h3>
            <button class="modal-close" id="btnCloseModal"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body" id="modalWorkflowsList">
            <!-- Loaded from database -->
        </div>
    </div>
</div>

<!-- ========== TOAST NOTIFICATION ========== -->
<div class="toast-container" id="toastContainer"></div>

<script src="js/database.js"></script>
<script src="js/workflow.js"></script>
</body>
</html>
